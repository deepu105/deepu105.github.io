<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="icon" href="/assets/images/logo.png">

    <title>Create full Microservice stack using JHipster Domain Language under 30 minutes | Technorage</title>

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Create full Microservice stack using JHipster Domain Language under 30 minutes | Technorage</title>
<meta name="generator" content="Jekyll v2.0.0" />
<meta property="og:title" content="Create full Microservice stack using JHipster Domain Language under 30 minutes" />
<meta name="author" content="deepu" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Create full Microservice stack using JHipster Domain Language under 30 minutes" />
<meta property="og:description" content="Create full Microservice stack using JHipster Domain Language under 30 minutes" />
<meta property="og:site_name" content="Technorage" />
<meta property="og:image" content="https://cdn-images-1.medium.com/max/1000/1*b4krMVZ-mqjxAIh_EM1jhQ.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-06-12T00:00:00+02:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"deepu"},"description":"Create full Microservice stack using JHipster Domain Language under 30 minutes","@type":"BlogPosting","headline":"Create full Microservice stack using JHipster Domain Language under 30 minutes","dateModified":"2019-06-12T00:00:00+02:00","datePublished":"2019-06-12T00:00:00+02:00","url":"https://medium.com/jhipster/create-full-microservice-stack-using-jhipster-domain-language-under-30-minutes-ecc6e7fc3f77","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/images/logo.png"},"name":"deepu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://medium.com/jhipster/create-full-microservice-stack-using-jhipster-domain-language-under-30-minutes-ecc6e7fc3f77"},"image":"https://cdn-images-1.medium.com/max/1000/1*b4krMVZ-mqjxAIh_EM1jhQ.png","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
        
    <link href="/assets/css/screen.css" rel="stylesheet">

    <link href="/assets/css/main.css" rel="stylesheet">

    <script src="/assets/js/jquery.min.js"></script>

</head>




<body class="layout-post">
	<!-- defer loading of font and font awesome -->
	<noscript id="deferred-styles">
		<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css" crossorigin="anonymous">
	</noscript>


<!-- Begin Menu Navigation
================================================== -->
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down pr-md-0 pl-md-0">

    <div class="container">

    <!-- Begin Logo -->
    <a class="navbar-brand" href="/">
        <h2>Deepu K Sasidharan</h2>
    </a>
    <!-- End Logo -->

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarMediumish">

        <!-- Begin Menu -->

            <ul class="navbar-nav ml-auto">

                
                <li class="nav-item">
                
                    <a class="nav-link" href="/">About</a>
                </li>
            
                
                <li class="nav-item active">
                
                    <a class="nav-link" href="/blogs/"><i class="fas fa-blog"></i> Blog</a>
                </li>

                <li class="nav-item">
                    <a target="_blank" class="nav-link" href="https://www.packtpub.com/eu/application-development/full-stack-development-jhipster"><i class="fas fa-book"></i> Book</a>
                </li>

                <li class="nav-item">
                    <a target="_blank" class="nav-link" href="https://www.youtube.com/playlist?list=PLxayiD7e52nPpb-sSaoOPc-zXGhmOaNHK"><i class="fab fa-youtube"></i> Videos</a>
                </li>

                <li class="nav-item">
                    <a target="_blank" class="nav-link" href="https://speakerdeck.com/deepu105"><i class="fab fa-speaker-deck"></i> Presentations</a>
                </li>

                <script src="/assets/js/lunr.js"></script>


<style>
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>


<form class="bd-search" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
    <input type="text" class="form-control text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."/>
</form>

<div id="lunrsearchresults">
    <ul></ul>
</div>

<script src="/assets/js/lunrsearchengine.js"></script>

            </ul>

        <!-- End Menu -->

    </div>

    </div>
</nav>
<!-- End Navigation
================================================== -->

<div class="site-content">

<div class="container">

<!-- Content
================================================== -->
<div class="main-content">
    <!-- Site Title
================================================== -->
<div class="mainheading">
    <h1 class="sitetitle">Technorage</h1>
    <p class="lead">
        Where I rage about technology and stuff!
    </p>
</div>
<!-- Begin Article
================================================== -->
<div class="container">
    <div class="row">

        <!-- Post Share -->
        <div class="col-md-2 pl-0">
            <div class="share sticky-top sticky-top-offset">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
            <a target="_blank" href="https://twitter.com/intent/tweet?text=Create full Microservice stack using JHipster Domain Language under 30 minutes&url=/create-full-microservice-stack-using-j-hipster-domain-language-under-30-minutes/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fab fa-twitter"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://facebook.com/sharer.php?u=/create-full-microservice-stack-using-j-hipster-domain-language-under-30-minutes/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
                <i class="fab fa-facebook-f"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=/create-full-microservice-stack-using-j-hipster-domain-language-under-30-minutes/" onclick="window.open(this.href, 'width=550,height=435');return false;">
                <i class="fab fa-linkedin-in"></i>
            </a>
        </li>

    </ul>
    
    <div class="sep">
    </div>
    <ul>
        <li>
        <a class="small smoothscroll" href="#disqus_thread"></a>
        </li>
    </ul>
    
</div>

        </div>

        <!-- Post -->
        

        <div class="col-md-9 flex-first flex-md-unordered">
            <div class="mainheading">

                <!-- Author Box -->
                
                <div class="row post-top-meta">
                    <div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0">
                        
                        <img class="author-thumb" src="https://www.gravatar.com/avatar/7f408bc67dc9ae3b288ee92d16d3c4c2?s=250&d=mm&r=x" alt="Deepu K Sasidharan">
                        
                    </div>
                    <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left">
                        <a target="_blank" class="link-dark" href="https://www.deepu.tech">Deepu K Sasidharan</a><a target="_blank" href="https://twitter.com/deepu105" class="btn follow">Follow</a>
                        <span class="author-description">JHipster co-lead, Java, JS, Cloud Native Advocate, Dev @ XebiaLabs, Author, Speaker, Software craftsman. Loves simple & beautiful code. bit.ly/JHIPSTER-BOOK</span>
                    </div>
                </div>
                

                <!-- Post Title -->
                <h1 class="posttitle">Create full Microservice stack using JHipster Domain Language under 30 minutes</h1>

            </div>

            <!-- Adsense if enabled from _config.yml (change your pub id and slot) -->
            
            <!-- End Adsense -->

            <!-- Post Featured Image -->
            

            
            <img class="featured-image img-fluid lazyimg" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAACCAQAAAA3fa6RAAAADklEQVR42mNkAANGCAUAACMAA2w/AMgAAAAASUVORK5CYII=" data-src="https://cdn-images-1.medium.com/max/1000/1*b4krMVZ-mqjxAIh_EM1jhQ.png" alt="Create full Microservice stack using JHipster Domain Language under 30 minutes">
            

            
            <!-- End Featured Image -->

            <!-- Post Content -->
            <div class="article-post">
                <!-- Toc if any -->
                
                <!-- End Toc -->
                <p>It‚Äôs been quite a while since I wrote a blog, I did <a href="https://mytechnorage.blogspot.com/">a few</a> some years ago but never really continued writing. So when I decided to start writing again, I didn‚Äôt have to think a lot about a topic as it was very obvious ‚Äî <a href="https://www.jhipster.tech/">JHipster</a>.</p>

<p>JHipster is a development platform for Java web applications and microservices development. If you are a JVM developer you might have already heard about <a href="https://www.jhipster.tech/">JHipster</a>. If not, well, you are missing out on a lot and I highly recommend you check it out. You can also check out my book ‚Äú<strong>Full Stack Development with JHipster</strong>‚Äù on <a href="https://www.amazon.com/Stack-Development-JHipster-Deepu-Sasidharan/dp/178847631X">Amazon</a> and <a href="https://www.packtpub.com/application-development/full-stack-development-jhipster">Packt</a> to learn about JHipster.</p>

<p>I have been working on JHipster from April 2015 and the coolest feature that I got to implement so far is definitely multiple applications generation using JDL. This feature is available in the latest version of JHipster. If you are not familiar with JDL, I recommend you to check out the docs at <a href="https://www.jhipster.tech/jdl/">https://www.jhipster.tech/jdl/</a></p>

<h2 id="the-e-commerce-application">The E-Commerce application</h2>

<p>So let us see how we can create a microservice stack using JHipster. We will build an e-commerce store today. The stack includes-</p>

<ul>
  <li>
    <p>Service discovery using <a href="https://www.jhipster.tech/jhipster-registry/">JHipster Registry</a>, a Spring boot application that packs Eureka server and Spring cloud config server.</p>
  </li>
  <li>
    <p><a href="https://www.jhipster.tech/api-gateway/">API management and Gateway</a> using Spring Boot, Netflix Zuul, ReactJS, and Swagger.</p>
  </li>
  <li>
    <p>Microservices using Spring Boot.</p>
  </li>
  <li>
    <p>Monitoring using <a href="https://www.jhipster.tech/monitoring/#jhipster-console">JHipster Console</a> which is made of the Elastic stack(ELK) and Zipkin.</p>
  </li>
</ul>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*b4krMVZ-mqjxAIh_EM1jhQ.png" alt="Microservice application architecture" /><em>Microservice application architecture</em></p>

<p>The Gateway routes incoming requests to two microservices, Invoice application, and Notification application.</p>

<h3 id="requirements">Requirements</h3>

<p>In order to follow this tutorial, you would need a recent version of <strong>Docker</strong>, <strong>Docker-compose</strong>, <strong>NodeJS</strong> and <strong>Java</strong> installed on your computer. The below are the versions I have installed(<strong>Update</strong>: With JHipster 6+ you can use Java 11 &amp; 12).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>$ docker -v                                                                                                                       
Docker version 18.06.1-ce, build e68fc7a

$ docker-compose -v                                
docker-compose version 1.20.1, build 5d8c71b

$ node -v                
v8.11.4

$ java -version          
openjdk version "1.8.0_212"
OpenJDK Runtime Environment (Zulu 8.38.0.13-CA-linux64) (build 1.8.0_212-b04)
OpenJDK 64-Bit Server VM (Zulu 8.38.0.13-CA-linux64) (build 25.212-b04, mixed mode)
</pre></td></tr></tbody></table></code></pre></div></div>

<p>First, install the latest version of JHipster</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>$ npm install generator-jhipster -g
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Verify that you have version <strong>5.3.4</strong> or above by running</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>$ jhipster --version
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="creating-the-jdl">Creating the JDL</h3>

<p>Now let us create our JDL. Head over to the <a href="https://start.jhipster.tech/jdl-studio/">JDL Studio</a> or your favorite IDE/Editor(<em>You can use <a href="https://www.jhipster.tech/jhipster-ide/">JHipster IDE</a> plugin if you like</em>).</p>

<p>First, let us define our applications. We will start with the Gateway</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>application {
  config {
    baseName store,
    applicationType gateway,
    packageName com.jhipster.demo.store,
    serviceDiscoveryType eureka,
    authenticationType jwt,
    prodDatabaseType mysql,
    cacheProvider hazelcast,
    buildTool gradle,
    clientFramework react,
    testFrameworks [protractor]
  }
  entities *
}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Most of the options are self-explanatory, we are building an application named <strong>Store</strong> of type <strong>Gateway</strong> with <strong>JWT</strong> authentication and <strong>Eureka</strong>-based service discovery. The application uses a <strong>MySQL</strong> database and <strong>Hazelcast</strong> for the cache. It‚Äôs built using <strong>Gradle</strong>. For the client-side, it uses <strong>React</strong> and <strong>Sass</strong>. It also has <strong>Protractor</strong> for end-to-end testing.</p>

<p>At the end of the definition you can see <code class="highlighter-rouge">entities *</code>, we will come to this later.</p>

<p>Now let us define our Invoice microservice</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>application {
  config {
    baseName invoice,
    applicationType microservice,
    packageName com.jhipster.demo.invoice,
    serviceDiscoveryType eureka,
    authenticationType jwt,
    prodDatabaseType mysql,
    buildTool gradle,
    serverPort 8081
  }
  entities Invoice, Shipment
}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>It follows similar options like our Gateway and since it is microservice it doesn‚Äôt define any client-side options and also skips user management as it will be handled by the Gateway. Additionally, we have also mentioned a custom port <strong>8081</strong> since we do not want this application to conflict with the default port 8080 used by the Gateway.</p>

<p>Now let us define the second microservice, the Notification application</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>application {
  config {
    baseName notification,
    applicationType microservice,
    packageName com.jhipster.demo.notification,
    serviceDiscoveryType eureka,
    authenticationType jwt,
    databaseType mongodb,
    cacheProvider no,
    enableHibernateCache false,
    buildTool gradle,
    serverPort 8082
  }
  entities Notification
}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This application follows many options similar to the Gateway and Invoice application but instead of using MySQL it uses <strong>MongoDB</strong> as its database and also disables cache.</p>

<p>Now that our application definitions are done, we will proceed to define our entity model.</p>

<p>For our Gateway store application, let us define the below entities and enums</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre></td><td class="rouge-code"><pre>/** Product sold by the Online store */
entity Product {
    name String required
    description String
    price BigDecimal required min(0)
    size Size required
    image ImageBlob
}

enum Size {
    S, M, L, XL, XXL
}

entity ProductCategory {
    name String required
    description String
}

entity Customer {
    firstName String required
    lastName String required
    gender Gender required
    email String required pattern(/^[^@\s]+@[^@\s]+\.[^@\s]+$/)
    phone String required
    addressLine1 String required
    addressLine2 String
    city String required
    country String required
}

enum Gender {
    MALE, FEMALE, OTHER
}

entity ProductOrder {
    placedDate Instant required
    status OrderStatus required
    code String required
    invoiceId Long
}

enum OrderStatus {
    COMPLETED, PENDING, CANCELLED
}

entity OrderItem {
    quantity Integer required min(0)
    totalPrice BigDecimal required min(0)
    status OrderItemStatus required
}

enum OrderItemStatus {
    AVAILABLE, OUT_OF_STOCK, BACK_ORDER
}

relationship OneToOne {
    Customer{user(login) required} to User
}

relationship ManyToOne {
    OrderItem{product(name) required} to Product
}

relationship OneToMany {
    Customer{order} to ProductOrder{customer(email) required},
    ProductOrder{orderItem} to OrderItem{order(code) required},
    ProductCategory{product} to Product{productCategory(name)}
}

service Product, ProductCategory, Customer, ProductOrder, OrderItem with serviceClass
paginate Product, Customer, ProductOrder, OrderItem with pagination
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The JDL defines the entities, enums, the relationship between entities and options like pagination and service layer.</p>

<p>The entity field definition follows the syntax</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>entity &lt;entity name&gt; {
  &lt;field name&gt; &lt;type&gt; [&lt;validation&gt;*]
}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The relationship definition follows the syntax</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>relationship (OneToMany | ManyToOne | OneToOne | ManyToMany) {
    &lt;from entity&gt;[{&lt;relationship name&gt;[(&lt;display field&gt;)]}] 
    to 
    &lt;to entity&gt;[{&lt;relationship name&gt;[(&lt;display field&gt;)]}]
}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Refer the <a href="https://www.jhipster.tech/jdl/">JDL docs</a> for full DSL reference.</p>

<p>The Invoice microservice application has the following entities</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre>entity Invoice {
    code String required
    date Instant required
    details String
    status InvoiceStatus required
    paymentMethod PaymentMethod required
    paymentDate Instant required
    paymentAmount BigDecimal required
}

enum InvoiceStatus {
    PAID, ISSUED, CANCELLED
}

entity Shipment {
    trackingCode String
    date Instant required
    details String
}

enum PaymentMethod {
    CREDIT_CARD, CASH_ON_DELIVERY, PAYPAL
}

relationship OneToMany {
    Invoice{shipment} to Shipment{invoice(code) required}
}

service Invoice, Shipment with serviceClass
paginate Invoice, Shipment with pagination
microservice Invoice, Shipment with invoice
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Pay attention to the last <strong>microservice</strong> option declared here, it specifies that these entities belong to the microservice named <strong>invoice</strong> so that our Gateway knows where to route requests for these entities.</p>

<p>Now let us see the entities for the Notification microservice application</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>entity Notification {
    date Instant required
    details String
    sentDate Instant required
    format NotificationType required
    userId Long required
    productId Long required
}

enum NotificationType {
    EMAIL, SMS, PARCEL
}

microservice Notification with notification
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Now let us go back to the entities keyword we used in our application definitions.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre></td><td class="rouge-code"><pre>application {
  config {
    ...
  }
  entities *
}

application {
  config {
    ...
  }
  entities Invoice, Shipment
}

application {
  config {
    ...
  }
  entities Notification
}

/* Entities for Store Gateway */

entity Product {
    ...
}

entity ProductCategory {
    ...
}

entity Customer {
    ...
}

entity ProductOrder {
    ...
}

entity OrderItem {
    ...
}

microservice Invoice, Shipment with invoice

/* Entities for Invoice microservice */
entity Invoice {
    ...
}

entity Shipment {
    ...
}

/* Entities for notification microservice */

entity Notification {
    ...
}

microservice Notification with notification
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Here we instruct the store gateway application that it should contain all the entities defined in the JDL and the gateway will know to skip server-side code for the entities that belong to another microservice and hence will only generate the client-side code for those, here namely <strong>Invoice</strong>, <strong>Shipment</strong>, and <strong>Notification</strong>. We also instruct the Invoice application and Notification application to include its entities.</p>

<h3 id="generating-the-applications">Generating the applications</h3>

<p>Create a folder where we want to create our microservice stack.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>$ mkdir ecommerce &amp;&amp; cd ecommerce
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Now, let us put everything together into a JDL file. Let us call it <code class="highlighter-rouge">app.jdl</code> and save it into this folder.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
</pre></td><td class="rouge-code"><pre>application {
  config {
    baseName store,
    applicationType gateway,
    packageName com.jhipster.demo.store,
    serviceDiscoveryType eureka,
    authenticationType jwt,
    prodDatabaseType mysql,
    cacheProvider hazelcast,
    buildTool gradle,
    clientFramework react,
    testFrameworks [protractor]
  }
  entities *
}

application {
  config {
    baseName invoice,
    applicationType microservice,
    packageName com.jhipster.demo.invoice,
    serviceDiscoveryType eureka,
    authenticationType jwt,
    prodDatabaseType mysql,
    buildTool gradle,
    serverPort 8081
  }
  entities Invoice, Shipment
}

application {
  config {
    baseName notification,
    applicationType microservice,
    packageName com.jhipster.demo.notification,
    serviceDiscoveryType eureka,
    authenticationType jwt,
    databaseType mongodb,
    cacheProvider no,
    enableHibernateCache false,
    buildTool gradle,
    serverPort 8082
  }
  entities Notification
}

/* Entities for Store Gateway */

/** Product sold by the Online store */
entity Product {
    name String required
    description String
    price BigDecimal required min(0)
    size Size required
    image ImageBlob
}

enum Size {
    S, M, L, XL, XXL
}

entity ProductCategory {
    name String required
    description String
}

entity Customer {
    firstName String required
    lastName String required
    gender Gender required
    email String required pattern(/^[^@\s]+@[^@\s]+\.[^@\s]+$/)
    phone String required
    addressLine1 String required
    addressLine2 String
    city String required
    country String required
}

enum Gender {
    MALE, FEMALE, OTHER
}

entity ProductOrder {
    placedDate Instant required
    status OrderStatus required
    code String required
    invoiceId Long
}

enum OrderStatus {
    COMPLETED, PENDING, CANCELLED
}

entity OrderItem {
    quantity Integer required min(0)
    totalPrice BigDecimal required min(0)
    status OrderItemStatus required
}

enum OrderItemStatus {
    AVAILABLE, OUT_OF_STOCK, BACK_ORDER
}

relationship OneToOne {
    Customer{user(login) required} to User
}

relationship ManyToOne {
 OrderItem{product(name) required} to Product
}

relationship OneToMany {
   Customer{order} to ProductOrder{customer(email) required},
   ProductOrder{orderItem} to OrderItem{order(code) required} ,
   ProductCategory{product} to Product{productCategory(name)}
}

service Product, ProductCategory, Customer, ProductOrder, OrderItem with serviceClass
paginate Product, Customer, ProductOrder, OrderItem with pagination

/* Entities for Invoice microservice */
entity Invoice {
    code String required
    date Instant required
    details String
    status InvoiceStatus required
    paymentMethod PaymentMethod required
    paymentDate Instant required
    paymentAmount BigDecimal required
}

enum InvoiceStatus {
    PAID, ISSUED, CANCELLED
}

entity Shipment {
    trackingCode String
    date Instant required
    details String
}

enum PaymentMethod {
    CREDIT_CARD, CASH_ON_DELIVERY, PAYPAL
}

relationship OneToMany {
    Invoice{shipment} to Shipment{invoice(code) required}
}

service Invoice, Shipment with serviceClass
paginate Invoice, Shipment with pagination
microservice Invoice, Shipment with invoice

/* Entities for notification microservice */

entity Notification {
    date Instant required
    details String
    sentDate Instant required
    format NotificationType required
    userId Long required
    productId Long required
}

enum NotificationType {
    EMAIL, SMS, PARCEL
}

microservice Notification with notification
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Now let us invoke JHipster CLI to import this file</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>$ jhipster import-jdl app.jdl
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This will create the <strong>store</strong>, <strong>invoice</strong> and <strong>notification</strong> folders and will do the below in each of the folders</p>

<ul>
  <li>
    <p>Generate the appropriate application and entities configuration.</p>
  </li>
  <li>
    <p>Generate the application and entities source code based on the configurations.</p>
  </li>
  <li>
    <p>Install the NPM dependencies for the application.</p>
  </li>
</ul>

<p>Once the process is complete you should see the below on your console</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>Entity Product generated successfully.
Entity ProductCategory generated successfully.
Entity Customer generated successfully.
Entity ProductOrder generated successfully.
Entity OrderItem generated successfully.
Entity Invoice generated successfully.
Entity Shipment generated successfully.
Entity Notification generated successfully.
Congratulations, JHipster execution is complete!
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Walk around the generated code to familiarize yourself.</p>

<h3 id="running-the-applications-with-docker">Running the applications with Docker</h3>

<p>Now that our applications are created its time to test them locally using Docker. To do this first let us generate some docker compose configurations using JHipster.</p>

<p>Create a new folder inside the <strong>ecommerce</strong> folder and run the JHipster docker-compose command</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>$ mkdir docker-compose &amp;&amp; cd docker-compose
$ jhipster docker-compose
</pre></td></tr></tbody></table></code></pre></div></div>

<p>It will prompt you with a few questions, choose the answers as highlighted below</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>üê≥  Welcome to the JHipster Docker Compose Sub-Generator üê≥
Files will be generated in folder: /home/deepu/workspace/temp/ecommerce/docker-compose
‚úî Docker is installed

? Which *type* of application would you like to deploy? Microservice application

? Which *type* of gateway would you like to use? JHipster gateway based on Netflix Zuul

? Enter the root directory where your gateway(s) and microservices are located ../

3 applications found at /home/deepu/workspace/temp/ecommerce/
? Which applications do you want to include in your configuration? invoice, notification, store

? Which applications do you want to use with clustered databases (only available with MongoDB and Couchbase)? 

? Do you want to setup monitoring for your applications ? Yes, for logs and metrics with the JHipster Console (based on ELK and Zipkin)

? You have selected the JHipster Console which is based on the ELK stack and additional technologies, which one do you want to use ? Zipkin, for distributed tracing (only compatible with
 JHipster &gt;= v4.2.0)

JHipster registry detected as the service discovery and configuration provider used by your apps
? Enter the admin password used to secure the JHipster Registry? admin
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This will generate all the required docker-compose configurations for the stack and will also print out further instructions to build the docker images.</p>

<p><strong>Note:</strong> In the latest JHipster versions we migrated to using <a href="https://github.com/GoogleContainerTools/jib">Jib</a> for creating Docker images. This is a huge improvement over the Docker Maven plugin that we were using, as a result the command to create an image has changed to <code class="highlighter-rouge">./gradlew -Pprod bootWar jibDockerBuild</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>Docker Compose configuration generated with missing images!
To generate the missing Docker image(s), please run:
  ./gradlew -Pprod bootWar jibDockerBuild in /home/deepu/workspace/temp/ecommerce/invoice
  ./gradlew -Pprod bootWar jibDockerBuild in /home/deepu/workspace/temp/ecommerce/notification
  ./gradlew -Pprod bootWar jibDockerBuild in /home/deepu/workspace/temp/ecommerce/store
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Follow the instructions and build the docker images. Once all 3 images are built run the below command from the <strong>docker-compose</strong> folder to fire everything up.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>$ docker-compose up -d
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Once the containers start you can stream the logs using below command</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>$ docker-compose logs -f
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Now point your favorite browser to <a href="http://localhost:8080/">http://localhost:8080/</a> and see the E-Commerce microservice application in action.</p>

<p><img src="https://cdn-images-1.medium.com/max/2604/1*NR3QX_Q88_a4cWJ9X3fcnw.png" alt="Gateway application(Store)" /><em>Gateway application(Store)</em></p>

<p>You can see the JHipster registry in action at <a href="http://localhost:8761/#/">http://localhost:8761/</a></p>

<p><img src="https://cdn-images-1.medium.com/max/2604/1*F-MV1Q_jsBvUHHeInJR8TA.png" alt="JHipster Registry" /><em>JHipster Registry</em></p>

<p>And finally the JHipster console at <a href="http://localhost:5601">http://localhost:5601</a>/</p>

<p><img src="https://cdn-images-1.medium.com/max/2616/1*v2tJsdLIJcVwm7RDAI_YVg.png" alt="JHipster Console- Kibana dashboard" /><em>JHipster Console- Kibana dashboard</em></p>

<p>Once you are done playing around, you can shut everything down by running the below command on the <strong>docker-compose</strong> folder</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker-compose down
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Hope you had fun creating microservices using JHipster. To learn how to convert a JHipster monolith to microservices check out my book ‚Äú<em>Full Stack Development with JHipster</em>‚Äù on <a href="https://www.amazon.com/Stack-Development-JHipster-Deepu-Sasidharan/dp/178847631X">Amazon</a> and <a href="https://www.packtpub.com/application-development/full-stack-development-jhipster">Packt</a>.</p>

<p>In the coming weeks, I‚Äôll write some posts about deploying this microservice stack to various cloud providers like GCP, Azure, AWS, Heroku and so on.</p>

<p>If you like JHipster don‚Äôt forget to give it a star on <a href="https://github.com/jhipster/generator-jhipster">Github</a>.</p>

<p>If you like this article, please leave a like or a comment.</p>

<p>You can follow me on <a href="https://twitter.com/deepu105">Twitter</a> and <a href="https://www.linkedin.com/in/deepu05/">LinkedIn</a>.</p>

<p>My other related posts:</p>

<ol>
  <li>
    <p><a href="https://dev.to/deepu105/deploying-jhipster-microservices-on-azure-kubernetes-service-aks-2g6d">Deploying JHipster Microservices on Azure Kubernetes Service (AKS)</a></p>
  </li>
  <li>
    <p><a href="https://medium.com/@deepu105/jhipster-microservices-with-istio-service-mesh-on-kubernetes-a7d0158ba9a3">JHipster microservices with Istio service mesh on Kubernetes</a></p>
  </li>
</ol>

<p>Originally published in <a href="https://medium.com/jhipster/create-full-microservice-stack-using-jhipster-domain-language-under-30-minutes-ecc6e7fc3f77">Medium</a> on Sep 22, 2018</p>

            </div>

            <!-- Rating -->
            

            <!-- Post Date -->
            <p>
            <small>
                <span class="post-date"><time class="post-date" datetime="2019-06-12">12 Jun 2019</time></span>           
                
                </small>
            </p>

            <!-- Post Categories -->
            <div class="after-post-cats">
                <ul class="tags mb-4">
                    
                    
                </ul>
            </div>
            <!-- End Categories -->

            <!-- Post Tags -->
            <div class="after-post-tags">
                <ul class="tags">
                    
                    
                    <li>
                        <a class="smoothscroll" href="/tags#docker">#docker</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/tags#java,">#java,</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/tags#jhipster,">#jhipster,</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/tags#microservices,">#microservices,</a>
                    </li>
                    
                </ul>
            </div>
            <!-- End Tags -->

            <!-- Prev/Next -->
            <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
            
            
            <a class="next d-block col-md-6 text-lg-right" href="/deploy-a-web-app-to-azure-app-service-using-terraform/">Deploy a web app to Azure App Service using Terraform &raquo; </a>
            
            <div class="clearfix"></div>
            </div>
            <!-- End Categories -->

        </div>
        <!-- End Post -->

    </div>
</div>
<!-- End Article
================================================== -->

<!-- Begin Comments
================================================== -->

    <div class="container">
        <div id="comments" class="row justify-content-center mb-5">
            <div class="col-md-8">
                <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'deepu-tech'; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>

            </div>
        </div>
    </div>

<!--End Comments
================================================== -->

<!-- Review with LD-JSON, adapt it for your needs if you like, but make sure you test the generated HTML source code first: 
https://search.google.com/structured-data/testing-tool/u/0/
================================================== -->

</div>


    
</div>

<!-- Categories Jumbotron
================================================== -->
<div class="jumbotron fortags">
	<div class="d-md-flex h-100">
		<div class="col-md-4 transpdark align-self-center text-center h-100">
            <div class="d-md-flex align-items-center justify-content-center h-100">
                <h2 class="d-md-block align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">‚Üí</span></h2>
            </div>
		</div>
		<div class="col-md-8 p-5 align-self-center text-center">
            
            
                
                    <a class="mt-1 mb-1" href="/tags#jhipster,">jhipster, (3)</a>
                
                    <a class="mt-1 mb-1" href="/tags#java,">java, (2)</a>
                
                    <a class="mt-1 mb-1" href="/tags#microservices,">microservices, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#docker">docker (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#azure,">azure, (2)</a>
                
                    <a class="mt-1 mb-1" href="/tags#terraform">terraform (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#writing,">writing, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#medium,">medium, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#development,">development, (2)</a>
                
                    <a class="mt-1 mb-1" href="/tags#tech">tech (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#linux,">linux, (3)</a>
                
                    <a class="mt-1 mb-1" href="/tags#fedora,">fedora, (2)</a>
                
                    <a class="mt-1 mb-1" href="/tags#gnome">gnome (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#kubernetes,">kubernetes, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#microservices">microservices (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#gnome,">gnome, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#desktop">desktop (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#terminal,">terminal, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#oh-my-zsh,">oh-my-zsh, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#zsh">zsh (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#go,">go, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#programming,">programming, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#languages,">languages, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#thepragmaticprogrammer">thepragmaticprogrammer (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#typescript,">typescript, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#react,">react, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#javascript,">javascript, (1)</a>
                
                    <a class="mt-1 mb-1" href="/tags#webdev">webdev (1)</a>
                
            
            
		</div>
	</div>
</div>

<!-- Begin Footer
================================================== -->
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                Copyright ¬© 2019 Deepu K Sasidharan 
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">    
                <a target="_blank" href="https://www.wowthemes.net/mediumish-free-jekyll-template/">Mediumish Jekyll Theme</a> by WowThemes.net |
                Domain by 
                <a href="https://js.org" target="_blank" title="JS.ORG | JavaScript Community">
                    <img src="https://logo.js.org/dark_tiny.png" style="width:50px" alt="JS.ORG Logo">
                </a> | 
                Hosted with <i class="far fa-heart"></i> by <a href="https://pages.github.com/" target="_blank">Github</a>
            </div>
        </div>
    </div>
</footer>
<!-- End Footer
================================================== -->

</div> <!-- /.site-content -->

<!-- Scripts
================================================== -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

<script src="/assets/js/mediumish.js"></script>


<script src="/assets/js/lazyload.js"></script>


<script src="/assets/js/ie10-viewport-bug-workaround.js"></script> 


<script id="dsq-count-scr" src="//deepu-tech.disqus.com/count.js"></script>


</body>
</html>
